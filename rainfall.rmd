---
title: "Rainfall Report"
author: Group B3
urlcolor: red
linkcolor: red
output: pdf_document
header-includes:
   - \usepackage{color}
   - \usepackage{caption}
   - \captionsetup[figure]{font={small, color=gray}, width=.8\linewidth}
---


```{r include = FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


```{r include = FALSE}
library(dplyr)
library(ggplot2)
```


```{r include = FALSE}
sys.source('R/functions/GetData.R', envir = knitr::knit_global())
X <- GetData()
readings <- X$readings
stations <- X$stations
rm(X)
```


```{r include = FALSE}
sys.source('R/functions/RainfallAverages.R', envir = knitr::knit_global())
averages <- RainfallAverages(readings = readings)
str(averages)
```


```{r include = FALSE}
sys.source('R/functions/RainfallAveragesReduce.R', envir = knitr::knit_global())
reduced <- RainfallAveragesReduce(averages = averages)
str(reduced)
```


```{r include = FALSE}
sys.source('R/functions/RainfallExtremes.R', envir = knitr::knit_global())
extremes <- RainfallExtremes(readings = readings)
str(extremes)
```



## Rainfall Graphs

\vspace{10pt}

**Mean Rainfall**: The line graph of mean rainfall, per month, against dates during the years $1850$ to $1900$.
```{r out.width = '45%', fig.align = 'center', fig.cap = 'Mean rainfall per month'}

graphics::par(mar = c(2, 6, 1, 2) )  # mar = c(bottom, left, top, right)

plot(x = averages$date, y = averages$mean_rainfall_month,
     type = 'l', frame.plot = FALSE, xlab = 'Date', ylab = 'Mean Rainfall per Month')
```

\vspace{20pt}

**A Raster Representation of Mean Rainfall**: A raster representation of mean rainfall per month every year; for the years $1850$ to $1900$.
```{r out.width = '60%', fig.align = 'center', fig.cap = 'A raster representation of mean rainfall'}

graphics::par(mar = c(1, 6, 1, 2) )  # mar = c(bottom, left, top, right)

ggplot(data = averages) +
  geom_raster(mapping = aes(x = year, y = month, fill = mean_rainfall_month )) +
  theme_minimal()
```

\pagebreak

**The Mean Rainfall per Month Across the Years**: Each bar represents the mean amount of rainfall that fell, during the named month, across the years 1850 to 1900.
```{r out.width = '60%', fig.align = 'center', fig.cap = 'The mean rainfall per month across the years.'}
ggplot(data = reduced, mapping = aes(x = month, y = mean)) +
  geom_bar(stat = 'identity') +
  geom_text(mapping = aes(label  = round(mean, digits = 1)), vjust = 0, nudge_y = 0.25) +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 11, angle = 90),
        axis.text.y = element_text(face = "bold", size = 11),
        axis.title.y = element_text(size = 13),
        aspect.ratio = 0.65) +
  ylab(label = 'Mean Rainfall\n') +
  xlab(label = '')
```


\pagebreak

## Extreme Tables

\vspace{10pt}

```{r include = FALSE}
sys.source('R/functions/HighestIndividualReadings.R', envir = knitr::knit_global())
hir <- HighestIndividualReadings(readings = readings, stations = stations)

sys.source('R/functions/HLAS.R', envir = knitr::knit_global())
hlas <- HLAS(extremes = extremes, stations = stations)

sys.source('R/functions/WettestMonthTallies.R', envir = knitr::knit_global())
wmt <- WettestMonthTallies(readings = readings)
```

\footnotesize

```{r}
knitr::kable(hir, caption = "Highest Individual Readings")
```

\vspace{20pt}

```{r}
knitr::kable(x = hlas$highest, caption = 'Highest Annual Station Records')
```

\vspace{20pt}

```{r}
knitr::kable(x = hlas$lowest, caption = 'Lowest Annual Station Records')
```

\normalsize

\vspace{20pt}

\footnotesize

```{r}
knitr::kable(x = wmt, caption = 'Wettest Month Crown Tallies (1850 - 1900)', format = 'simple')
```

\normalsize
















